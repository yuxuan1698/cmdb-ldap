'use strict'
import {PureComponent} from 'react';
import {
  Modal,Button,Tooltip,notification, Icon,Tag
} from 'antd';
import {formatMessage} from 'umi/locale';
const ButtonGroup = Button.Group;

const restpasssvg=props=><svg t="1562149128709" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="28104" width="20" height="20"><path d="M567.404089 353.942187c-19.572053 19.572053-9.989689 60.867698 21.408427 92.263537 31.39584 31.351467 72.692622 40.981618 92.263537 21.408427 19.528818-19.52768 9.944178-60.821049-21.453937-92.219164-31.39584-31.39584-72.690347-40.98048-92.218027-21.4528zM512 56.951467c-251.352178 0-455.049671 203.743004-455.049671 455.049671 0 251.306667 203.696356 455.049671 455.049671 455.049671 251.306667 0 455.049671-203.743004 455.049671-455.049671 0-251.306667-203.741867-455.049671-455.049671-455.049671z m226.18112 495.895893c-43.804444 43.802169-123.0336 37.845902-189.27616-9.898667L346.955093 744.89856c-15.630791 15.633067-41.024853 15.587556-56.701155-0.088747-15.721813-15.720676-15.766187-41.115876-0.088747-56.746666l15.315627-15.362276-43.533654-43.48928c-7.837013-7.883662-7.837013-20.60288-0.045511-28.396658 7.839289-7.79264 20.559644-7.79264 28.397796 0.045511l43.533653 43.534792 14.152818-14.199467-15.09376-15.092622c-7.883662-7.838151-7.883662-20.558507-0.045511-28.351147 7.793778-7.838151 20.514133-7.793778 28.351147 0.044373l15.09376 15.09376 14.153955-14.152817-43.490418-43.533654c-7.882524-7.839289-7.882524-20.514133-0.045511-28.351146 7.793778-7.839289 20.514133-7.793778 28.352285 0.045511l43.533653 43.533653 73.3184-73.3184c-47.519289-66.24256-53.431182-145.248711-9.673387-189.053156 50.834773-50.834773 149.324231-34.75456 219.909689 35.830898 70.632107 70.632107 86.666809 169.120427 35.832036 219.9552z" p-id="28105" fill="#d4237a"></path></svg>
const restsshkeysvg=props=><svg t="1562148420280" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23068" width="20" height="20"><path d="M512 512m-472.177778 0a472.177778 472.177778 0 1 0 944.355556 0 472.177778 472.177778 0 1 0-944.355556 0Z" fill="#31C5B3" p-id="23069"></path><path d="M91.022222 568.888889l62.577778-5.688889c0 17.066667 5.688889 34.133333 11.377778 39.822222 11.377778 11.377778 28.444444 17.066667 51.2 17.066667s34.133333-5.688889 45.511111-11.377778c11.377778-5.688889 11.377778-17.066667 11.377778-28.444444s-5.688889-17.066667-11.377778-22.755556c-5.688889-5.688889-17.066667-11.377778-45.511111-22.755555-22.755556-11.377778-39.822222-17.066667-51.2-28.444445-11.377778-5.688889-17.066667-11.377778-28.444445-22.755555-5.688889-11.377778-5.688889-28.444444-5.688889-39.822223 0-28.444444 11.377778-45.511111 28.444445-62.577777 17.066667-17.066667 45.511111-28.444444 79.644444-28.444445 34.133333 0 62.577778 5.688889 85.333334 22.755556 17.066667 17.066667 28.444444 39.822222 34.133333 68.266666H295.822222c0-17.066667-5.688889-28.444444-17.066666-34.133333-5.688889-5.688889-22.755556-5.688889-39.822223-5.688889-17.066667 0-28.444444 5.688889-39.822222 11.377778-5.688889 0-11.377778 11.377778-11.377778 17.066667 0 11.377778 5.688889 17.066667 11.377778 22.755555 5.688889 5.688889 22.755556 11.377778 45.511111 22.755556 39.822222 17.066667 62.577778 34.133333 68.266667 39.822222 17.066667 11.377778 22.755556 34.133333 22.755555 56.888889 0 28.444444-11.377778 51.2-34.133333 68.266666-22.755556 17.066667-51.2 28.444444-91.022222 28.444445-28.444444 0-51.2-5.688889-68.266667-11.377778s-28.444444-22.755556-39.822222-39.822222c-5.688889-17.066667-11.377778-34.133333-11.377778-51.2zM364.088889 568.888889l62.577778-5.688889c0 17.066667 5.688889 34.133333 11.377777 39.822222 11.377778 11.377778 28.444444 17.066667 51.2 17.066667s34.133333-5.688889 45.511112-11.377778c11.377778-5.688889 11.377778-17.066667 11.377777-28.444444s-5.688889-17.066667-11.377777-22.755556c-5.688889-5.688889-22.755556-11.377778-45.511112-22.755555s-39.822222-17.066667-51.2-28.444445c-11.377778-5.688889-22.755556-11.377778-28.444444-22.755555-5.688889-11.377778-5.688889-28.444444-5.688889-39.822223 0-28.444444 11.377778-45.511111 28.444445-62.577777 17.066667-22.755556 45.511111-28.444444 79.644444-28.444445 34.133333 0 62.577778 5.688889 85.333333 22.755556 17.066667 17.066667 28.444444 39.822222 28.444445 68.266666H563.2c0-17.066667-5.688889-28.444444-17.066667-34.133333-5.688889-5.688889-17.066667-5.688889-34.133333-5.688889s-28.444444 5.688889-39.822222 11.377778c-5.688889 0-11.377778 11.377778-11.377778 17.066667 0 11.377778 5.688889 17.066667 11.377778 22.755555 5.688889 5.688889 22.755556 11.377778 45.511111 22.755556 34.133333 17.066667 56.888889 28.444444 68.266667 39.822222 17.066667 11.377778 22.755556 34.133333 22.755555 56.888889 0 28.444444-11.377778 51.2-34.133333 68.266666-22.755556 17.066667-51.2 28.444444-91.022222 28.444445-28.444444 0-51.2-5.688889-68.266667-11.377778s-34.133333-22.755556-39.822222-39.822222c-5.688889-17.066667-11.377778-34.133333-11.377778-51.2zM830.577778 529.066667h-119.466667l-28.444444 136.533333h-62.577778L682.666667 358.4h62.577777l-22.755555 119.466667h119.466667l22.755555-119.466667h62.577778l-62.577778 307.2h-62.577778l28.444445-136.533333z" fill="#FFFFFF" p-id="23070"></path></svg>

export class ResetButtonGroup extends PureComponent {
  handleResetPassword=(userdn,username)=>{
    Modal.confirm({
      title: formatMessage({id:'userlist_userreset_password'},{username}),
      content: formatMessage({id:'userlist_userreset_password_msg'},{username}),
      onCancel: ()=>{Modal.destroyAll()},
      onOk: ()=>{
        const {dispatch}=this.props
        dispatch({type:'users/resetPasswordAction',payload:{userdn},callback:(data)=>{
          notification.success({
            message: formatMessage({id:'userlist_userreset_success'}),
            description: data.status
          })
        }})
      }
    })
  }
  handleResetSSHkey=(payload)=>{
    Modal.confirm({
      title: formatMessage({id:'userlist_userreset_sshkey'},{username:payload.username}),
      content: formatMessage({id:'userlist_userreset_sshkey_msg'},{username:payload.username}),
      onCancel: ()=>{Modal.destroyAll()},
      onOk: ()=>{
        const {dispatch}=this.props
        dispatch({type:'users/generateSSHKeyAndDownLoad',payload,callback:(data)=>{
          console.log(data)
        }})
      }
    })
  }
  render(){
    const {restpassworddata,restsshkeyddata}=this.props
    return (
      <div>
        {/* <ButtonGroup size="small"> */}
          <Tooltip placement="top" 
            title={formatMessage({id:'userlist_table_resetpassword'},{username:restpassworddata.username})} 
            getPopupContainer={trigger => trigger.parentNode.parentNode} >
              <Icon component={restpasssvg} onClick={this.handleResetPassword.bind(this,restpassworddata.userdn,restpassworddata.username)}/>
          </Tooltip>
          <Tooltip placement="top" 
            title={formatMessage({id:'userlist_userreset_sshkey'},{username:restpassworddata.username})} 
            getPopupContainer={trigger => trigger.parentNode.parentNode} >
              <Icon  onClick={this.handleResetSSHkey.bind(this,restsshkeyddata)} component={restsshkeysvg} />
          </Tooltip>
        {/* </ButtonGroup> */}
      </div>
    );
  }
}

