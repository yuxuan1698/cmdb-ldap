'use strict'
import {PureComponent} from 'react';
import {
  Modal,Button,Tooltip,notification, Icon,Tag
} from 'antd';
import {formatMessage} from 'umi/locale';
const ButtonGroup = Button.Group;

const restpasssvg=props=><svg t="1562149128709" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="28104" width="21" height="21"><path d="M567.404089 353.942187c-19.572053 19.572053-9.989689 60.867698 21.408427 92.263537 31.39584 31.351467 72.692622 40.981618 92.263537 21.408427 19.528818-19.52768 9.944178-60.821049-21.453937-92.219164-31.39584-31.39584-72.690347-40.98048-92.218027-21.4528zM512 56.951467c-251.352178 0-455.049671 203.743004-455.049671 455.049671 0 251.306667 203.696356 455.049671 455.049671 455.049671 251.306667 0 455.049671-203.743004 455.049671-455.049671 0-251.306667-203.741867-455.049671-455.049671-455.049671z m226.18112 495.895893c-43.804444 43.802169-123.0336 37.845902-189.27616-9.898667L346.955093 744.89856c-15.630791 15.633067-41.024853 15.587556-56.701155-0.088747-15.721813-15.720676-15.766187-41.115876-0.088747-56.746666l15.315627-15.362276-43.533654-43.48928c-7.837013-7.883662-7.837013-20.60288-0.045511-28.396658 7.839289-7.79264 20.559644-7.79264 28.397796 0.045511l43.533653 43.534792 14.152818-14.199467-15.09376-15.092622c-7.883662-7.838151-7.883662-20.558507-0.045511-28.351147 7.793778-7.838151 20.514133-7.793778 28.351147 0.044373l15.09376 15.09376 14.153955-14.152817-43.490418-43.533654c-7.882524-7.839289-7.882524-20.514133-0.045511-28.351146 7.793778-7.839289 20.514133-7.793778 28.352285 0.045511l43.533653 43.533653 73.3184-73.3184c-47.519289-66.24256-53.431182-145.248711-9.673387-189.053156 50.834773-50.834773 149.324231-34.75456 219.909689 35.830898 70.632107 70.632107 86.666809 169.120427 35.832036 219.9552z" p-id="28105" fill="#d4237a"></path></svg>
const restsshkeysvg=props=><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" >
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="test" transform="translate(0.799805, 0.799805)">
            <rect id="Rectangle" fill="#31C5B3" x="0" y="0.0001953125" width="19" height="19" rx="4"></rect>
            <path d="M16.079541,10.1618652 L13.4494141,10.1618652 L12.813916,13.2001953 L11.4130371,13.2001953 L12.8371094,6.39990234 L14.2333496,6.39990234 L13.6859863,9.02539062 L16.3161133,9.02539062 L16.8681152,6.39990234 L18.2643555,6.39990234 L16.8449219,13.2001953 L15.444043,13.2001953 L16.079541,10.1618652 Z M6.10322266,10.9968262 L7.43452148,10.9272461 C7.45307626,11.3509136 7.52574806,11.6369621 7.65253906,11.7854004 C7.85664165,12.0266125 8.23391652,12.1472168 8.784375,12.1472168 C9.24205958,12.1472168 9.5729482,12.0652677 9.77705078,11.9013672 C9.98115336,11.7374666 10.0832031,11.5395519 10.0832031,11.3076172 C10.0832031,11.1066071 9.99970787,10.9365241 9.83271484,10.7973633 C9.71520124,10.695312 9.39281676,10.5298677 8.86555176,10.3010254 C8.33828675,10.0721831 7.95328084,9.88122635 7.71052246,9.72814941 C7.46776409,9.57507248 7.27680734,9.37638469 7.13764648,9.13208008 C6.99848563,8.88777547 6.92890625,8.6017269 6.92890625,8.27392578 C6.92890625,7.70182006 7.13609819,7.22713405 7.55048828,6.84985352 C7.96487837,6.47257298 8.56480727,6.28393555 9.35029297,6.28393555 C10.1481485,6.28393555 10.7658588,6.47102677 11.2034424,6.84521484 C11.641026,7.21940291 11.8814614,7.71728205 11.9247559,8.33886719 L10.5841797,8.39916992 C10.5501626,8.07446127 10.4326507,7.8255217 10.2316406,7.65234375 C10.0306305,7.4791658 9.73375847,7.39257812 9.34101563,7.39257812 C8.9544577,7.39257812 8.67845949,7.4606113 8.5130127,7.59667969 C8.3475659,7.73274808 8.26484375,7.90437722 8.26484375,8.11157227 C8.26484375,8.30639746 8.34060797,8.46720314 8.49213867,8.59399414 C8.64366938,8.7238776 8.97919662,8.90169158 9.49873047,9.12744141 C10.2811237,9.46451991 10.7790028,9.73819882 10.9923828,9.94848633 C11.3109065,10.2577327 11.470166,10.6551082 11.470166,11.140625 C11.470166,11.7405629 11.232823,12.253131 10.7581299,12.6783447 C10.2834368,13.1035584 9.62243262,13.3161621 8.77509766,13.3161621 C8.19062208,13.3161621 7.6842388,13.2179779 7.25593262,13.0216064 C6.82762644,12.825235 6.52534268,12.5523292 6.34907227,12.2028809 C6.17280185,11.8534325 6.0908528,11.4514183 6.10322266,10.9968262 Z M0.503222656,10.9968262 L1.83452148,10.9272461 C1.85307626,11.3509136 1.92574806,11.6369621 2.05253906,11.7854004 C2.25664165,12.0266125 2.63391652,12.1472168 3.184375,12.1472168 C3.64205958,12.1472168 3.9729482,12.0652677 4.17705078,11.9013672 C4.38115336,11.7374666 4.48320313,11.5395519 4.48320313,11.3076172 C4.48320313,11.1066071 4.39970787,10.9365241 4.23271484,10.7973633 C4.11520124,10.695312 3.79281676,10.5298677 3.26555176,10.3010254 C2.73828675,10.0721831 2.35328084,9.88122635 2.11052246,9.72814941 C1.86776409,9.57507248 1.67680734,9.37638469 1.53764648,9.13208008 C1.39848563,8.88777547 1.32890625,8.6017269 1.32890625,8.27392578 C1.32890625,7.70182006 1.53609819,7.22713405 1.95048828,6.84985352 C2.36487837,6.47257298 2.96480727,6.28393555 3.75029297,6.28393555 C4.54814852,6.28393555 5.16585881,6.47102677 5.60344238,6.84521484 C6.04102595,7.21940291 6.28146137,7.71728205 6.32475586,8.33886719 L4.98417969,8.39916992 C4.95016259,8.07446127 4.83265074,7.8255217 4.63164063,7.65234375 C4.43063051,7.4791658 4.13375847,7.39257812 3.74101563,7.39257812 C3.3544577,7.39257812 3.07845949,7.4606113 2.9130127,7.59667969 C2.7475659,7.73274808 2.66484375,7.90437722 2.66484375,8.11157227 C2.66484375,8.30639746 2.74060797,8.46720314 2.89213867,8.59399414 C3.04366938,8.7238776 3.37919662,8.90169158 3.89873047,9.12744141 C4.6811237,9.46451991 5.17900284,9.73819882 5.39238281,9.94848633 C5.71090654,10.2577327 5.87016602,10.6551082 5.87016602,11.140625 C5.87016602,11.7405629 5.63282301,12.253131 5.15812988,12.6783447 C4.68343675,13.1035584 4.02243262,13.3161621 3.17509766,13.3161621 C2.59062208,13.3161621 2.0842388,13.2179779 1.65593262,13.0216064 C1.22762644,12.825235 0.925342678,12.5523292 0.749072266,12.2028809 C0.572801853,11.8534325 0.490852803,11.4514183 0.503222656,10.9968262 Z" id="Shape" fill="#FFFFFF" fill-rule="nonzero"></path>
        </g>
    </g>
</svg>

export class ResetButtonGroup extends PureComponent {
  handleResetPassword=(userdn,username)=>{
    Modal.confirm({
      title: formatMessage({id:'userlist_userreset_password'},{username}),
      content: formatMessage({id:'userlist_userreset_password_msg'},{username}),
      onCancel: ()=>{Modal.destroyAll()},
      onOk: ()=>{
        const {dispatch}=this.props
        dispatch({type:'users/resetPasswordAction',payload:{userdn},callback:(data)=>{
          notification.success({
            message: formatMessage({id:'userlist_userreset_success'}),
            description: data.status
          })
        }})
      }
    })
  }
  handleResetSSHkey=(payload)=>{
    Modal.confirm({
      title: formatMessage({id:'userlist_userreset_sshkey'},{username:payload.username}),
      content: formatMessage({id:'userlist_userreset_sshkey_msg'},{username:payload.username}),
      onCancel: ()=>{Modal.destroyAll()},
      onOk: ()=>{
        const {dispatch}=this.props
        dispatch({type:'users/generateSSHKeyAndDownLoad',payload,callback:(data)=>{
          console.log(data)
        }})
      }
    })
  }
  render(){
    const {restpassworddata,restsshkeyddata}=this.props
    return (
      <div>
        {/* <ButtonGroup size="small"> */}
          <Tooltip placement="top" 
            title={formatMessage({id:'userlist_table_resetpassword'},{username:restpassworddata.username})} 
            getPopupContainer={trigger => trigger.parentNode.parentNode} >
              <Icon style={{marginRight:4}} component={restpasssvg} onClick={this.handleResetPassword.bind(this,restpassworddata.userdn,restpassworddata.username)}/>
          </Tooltip>
          <Tooltip placement="top" 
            title={formatMessage({id:'userlist_userreset_sshkey'},{username:restpassworddata.username})} 
            getPopupContainer={trigger => trigger.parentNode.parentNode} >
              <Icon  onClick={this.handleResetSSHkey.bind(this,restsshkeyddata)} component={restsshkeysvg} />
          </Tooltip>
        {/* </ButtonGroup> */}
      </div>
    );
  }
}

